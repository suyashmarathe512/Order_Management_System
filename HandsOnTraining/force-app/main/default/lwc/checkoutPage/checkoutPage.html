<template>
  <div class="slds-box slds-theme_default checkout">
    <div class="slds-page-header">
      <div class="slds-page-header__row">
        <div class="slds-page-header__col-title">
          <div class="slds-media">
            <div class="slds-media__body">
              <div class="slds-page-header__name-title">
                <h1 class="slds-page-header__title slds-truncate" title="Checkout">Checkout</h1>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <template if:true={cart.length}>
      <div class="slds-section slds-is-open">
        <div class="slds-section__content">
          <div class="slds-grid slds-gutters slds-wrap">
            <div class="slds-col slds-size_1-of-1">
              <div class="slds-table_container">
                <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                  <thead>
                    <tr class="slds-line-height_reset">
                      <th class="slds-text-heading_label" scope="col">Product</th>
                      <th class="slds-text-heading_label" scope="col">Quantity</th>
                      <th class="slds-text-heading_label" scope="col">Price</th>
                      <th class="slds-text-heading_label" scope="col">Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <template for:each={cart} for:item="item">
                      <tr key={item.id} class="slds-hint-parent">
                        <td>
                          <div class="slds-truncate" title={item.name}>{item.name}</div>
                          <div class="slds-text-body_small slds-text-color_weak">SKU: {item.sku}</div>
                        </td>
                        <td>
                          <input type="number" min="1" value={item.qty} data-id={item.id} onchange={handleQtyChange} class="slds-input slds-assistive-text" />
                        </td>
                        <td class="slds-text-align_right">₹{item.price}</td>
                        <td>
                          <button data-id={item.id} onclick={removeLine} class="slds-button slds-button_outline-brand slds-button_neutral slds-button_small">Remove</button>
                        </td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          
          <div class="slds-box slds-theme_shade summary">
            <div class="slds-grid slds-gutters slds-wrap">
              <div class="slds-col slds-size_1-of-1">
                <div class="slds-text-heading_medium total">Total: ₹{total}</div>
              </div>
              
              <div class="slds-col slds-size_1-of-1">
                <div class="slds-form-element">
                  <label class="slds-form-element__label" for="accountId">Account Id (required)</label>
                  <div class="slds-form-element__control">
                    <input type="text" id="accountId" placeholder="Enter Account Id" onchange={handleAccountChange} class="slds-input" />
                  </div>
                </div>
              </div>
              
              <div class="slds-col slds-size_1-of-1">
                <div class="slds-button-group" role="group">
                  <button onclick={placeOrder} disabled={isLoading} class="slds-button slds-button_brand place-order-btn">Place Order</button>
                  <template if:true={orderResult}>
                    <button onclick={generateInvoice} disabled={isLoading} class="slds-button slds-button_success generate-invoice-btn">Generate Invoice</button>
                  </template>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </template>

    <template if:false={cart.length}>
      <div class="slds-text-align_center empty-cart">
        <div>Your cart is empty.</div>
        <div class="slds-text-body_small">Add items to your cart to proceed with checkout.</div>
      </div>
    </template>
  </div>
</template>
