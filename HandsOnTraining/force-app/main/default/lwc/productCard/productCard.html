<template>
  <article class="product-card" role="listitem" tabindex="0" aria-label={ariaLabel}>
    <!-- Red star if price came from org (fallback) -->
    <template if:true={isFetchedFromOrg}>
      <div class="org-star" title="Price from Org" aria-hidden="false">
        <!-- SVG star for crisp rendering -->
        <svg viewBox="0 0 24 24" class="org-star-icon" focusable="false" aria-hidden="true">
          <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
        </svg>
      </div>
    </template>

    <div class="card-header">
      <div class="product-image-wrapper" aria-hidden={imageHidden}>
        <template if:true={productImage}>
          <img src={productImage} alt={product.name} loading="lazy" class="product-image" />
        </template>
        <template if:false={productImage}>
          <div class="image-placeholder"></div>
        </template>
      </div>

      <div class="product-meta">
        <h3 class="product-title" title={product.name}>{product.name}</h3>
        <p class="product-family">{product.family}</p>
      </div>
    </div>

    <div class="card-body">
      <p class="product-desc" title={product.description}>{product.description}</p>
    </div>

    <div class="card-footer">
      <div class="price-block">
        <div class="price" aria-label="Price">
          <template if:true={product.price}>
            {formattedPrice}
          </template>
          <template if:false={product.price}>
            <span class="oos">Out Of Stock</span>
          </template>
        </div>
        <div class="sku" title={product.sku}>SKU: {product.sku}</div>
      </div>

      <div class="action-block">
        <lightning-button class="btn-view" variant="neutral" label="View" onclick={onView}></lightning-button>
        <lightning-button class="btn-add" variant="brand" label="Add" onclick={onAdd}></lightning-button>
      </div>
    </div>
  </article>
</template>
